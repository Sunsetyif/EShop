@using EShop.Web.ViewModels
@using EShop.Web.Code
@model EShop.Web.ViewModels.ShopViewModel
@{
    Layout = null;
    var defaultImg = "/Content/images/default-image_493.png";
}
<title>@ViewBag.Title - Chocolate Madness</title>

@Styles.Render("~/Content/css")
@Scripts.Render("~/bundles/modernizr")
@*@Scripts.Render("~/bundles/jquery")*@
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="pragma" content="no-cache" />
    <meta http-equiv="cache-control" content="max-age=604800" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Chocolate Madness</title>
    <!-- jQuery -->
    <!-- Bootstrap4 files-->
    <script src="~/Content/site/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <link href="~/Content/site/css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Font awesome 5 -->
    <link href="~/Content/site/fonts/fontawesome/css/fontawesome-all.min.css" type="text/css" rel="stylesheet">

    <!-- custom style -->
    <link href="~/Content/site/css/ui.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/site/css/responsive.css" rel="stylesheet" media="only screen and (max-width: 1200px)" />

    <!-- custom javascript -->
    <script src="~/Content/site/js/script.js" type="text/javascript"></script>

    <script type="text/javascript">
        /// some script

        // jquery ready start
        $(document).ready(function () {
            // jQuery code

        });
        // jquery end
    </script>

</head>
<body>
    <header class="section-header">
        <nav class="navbar navbar-top navbar-expand-lg navbar-dark bg-secondary">
            <div class="container">
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarsExample07">
                    <ul class="navbar-nav mr-auto">
                        <li><a href="https://www.google.com.ua/" class="nav-link"> <i class="fab fa-facebook"></i> </a></li>
                        <li><a href="https://www.google.com.ua/" class="nav-link"> <i class="fab fa-instagram"></i> </a></li>
                        <li><a href="https://www.google.com.ua/" class="nav-link"> <i class="fab fa-twitter"></i> </a></li>

                    </ul>
                    @if (Request.IsAuthenticated && User.IsInRole("admin")) { 
                        <ul class="navbar-nav">
                            <li class="nav-item"><a href="@Url.Action("Index","Product")" class="nav-link"> Products </a></li>
                            <li class="nav-item"><a href="@Url.Action("Index","Category")" class="nav-link"> Categories </a></li>
                            <li class="nav-item"><a href="@Url.Action("Index","Order")" class="nav-link"> Orders </a></li>
                        </ul>
                    }
                </div>
            </div>
        </nav>

        <section class="header-main shadow-sm">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-3 col-sm-4">
                        <div class="brand-wrap">

                            <h2 class="logo-text"><a href="@Url.Action("Index","Shop")">Chocolate Madness</a></h2>
                            <hr style="margin-right:70px" />
                        </div>
                    </div>
                    <div class="col-lg-4 col-xl-5 col-sm-8">
                        <form action="@Url.Action("Index","Shop")" class="search-wrap">
                            <div class="input-group w-100">
                                <input type="text" name="searchTerm" class="form-control" style="width:55%;" placeholder="Search">
                                @*<select class="custom-select" name="category_name">
                                        <option value="">All type</option>
                                        <option value="codex">Special</option>
                                        <option value="comments">Only best</option>
                                        <option value="content">Latest</option>
                                    </select>*@
                                <div class="input-group-append">
                                    <button class="btn btn-primary" type="submit">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="col-lg-5 col-xl-4 col-sm-12">
                        <div class="widgets-wrap float-right">
                            <a href="@Url.Action("Checkout","Shop")" class="widget-header mr-3">
                                <div class="icontext">
                                    <div class="icon-wrap"><i class="icon-sm round border fa fa-shopping-cart"></i></div>
                                    <div class="text-wrap">
                                        <span id="cartProductsCount" class="small badge badge-danger">0</span>
                                        <div>Cart</div>
                                    </div>
                                </div>
                            </a>
                      
                            <div class="widget-header dropdown">
                                @if (User.Identity.IsAuthenticated)
                                {
                                    <a href="#" data-toggle="dropdown" data-offset="20,10">
                                    <div class="icontext">
                                        <div class="icon-wrap"><i class="icon-sm round border fa fa-user"></i></div>
                                        <div class="text-wrap">
                                            <small> @User.Identity.Name</small>
                                            <div>My account <i class="fa fa-caret-down"></i> </div>
                                        </div>
                                    </div>
                                </a>
                                    <div class="dropdown-menu dropdown-menu-right">

                                        <a class="dropdown-item" href="@Url.Action("Register","Account")">Orders</a>
                                        <a class="dropdown-item" href="@Url.Action("Register","Account")">My Profile</a>
                                        <a class="dropdown-item" href="@Url.Action("Login","Account")">Log out</a>

                                    </div> <!--  dropdown-menu .// -->
                                }
                                else
                                {
                                     <a href="#" data-toggle="dropdown" data-offset="20,10">
                                    <div class="icontext">
                                        <div class="icon-wrap"><i class="icon-sm round border fa fa-user"></i></div>
                                        <div class="text-wrap">
                                            <small>Sign in | Join</small>
                                            <div>My account <i class="fa fa-caret-down"></i> </div>
                                        </div>
                                    </div>
                                </a>
                                     <div class="dropdown-menu dropdown-menu-right">
                                     
                                         <hr class="dropdown-divider">
                                         <a class="dropdown-item" href="@Url.Action("Login","Account")">Sign in</a>
                                         <a class="dropdown-item" href="@Url.Action("Register","Account")">Register</a>
                                         <a class="dropdown-item" href="@Url.Action("ForgotPassword","Account")">Forgot password?</a>

                                     </div> <!--  dropdown-menu .// -->
                                }
                               
                            </div>  <!-- widget-header .// -->
                        </div> <!-- widgets-wrap.// -->
                    </div> <!-- col.// -->
                </div> <!-- row.// -->
            </div> <!-- container.// -->
        </section> <!-- header-main .// -->
    </header>

    <section class="section-content bg padding-y">
        <div class="container">

            <div class="row">
                <aside class="col-sm-3">

                    <div class="card card-filter">
                        <article class="card-group-item">
                            <header class="card-header">
                                <a class="" aria-expanded="true" href="#" data-toggle="collapse" data-target="#collapse22">
                                    <i class="icon-action fa fa-chevron-down"></i>
                                    <h6 class="title">Featured Categories</h6>
                                </a>
                            </header>
                            <div style="" class="filter-content collapse show" id="collapse22">
                                <div class="card-body">


                                    <ul class="list-unstyled list-lg">
                                        @foreach (var category in Model.FeaturedCategories)
                                        {
                                            <li style="color:#007bff"><a data-href="@Url.Action("FilterProducts", "Shop", new { categoryID = category.ID, sortBy = Model.SortBy })" class="dataLink @(Model.CategoryID.HasValue && Model.CategoryID.Value == category.ID ? "active" : string.Empty)">@category.Name</a></li>
                                        }

                                    </ul>
                                </div> <!-- card-body.// -->
                            </div> <!-- collapse .// -->
                        </article> <!-- card-group-item.// -->

                        <article class="card-group-item">
                            <header class="card-header">
                                <a href="#" data-toggle="collapse" data-target="#collapse44">
                                    <i class="icon-action fa fa-chevron-down"></i>
                                    <h6 class="title">Sort by </h6>
                                </a>
                            </header>
                            <div class="filter-content collapse show" id="collapse44">
                                <div class="card-body">
                                    <form>
                                        <ul class="list-unstyled list-lg">
                                            <li><a href="@Url.Action("Index","Shop", new { sortBy = (int)SortbyEnums.Default })" class="@(Model.SortBy.HasValue ? Model.SortBy.Value==(int)SortbyEnums.Default ?"active":string.Empty:string.Empty)">Newest</a></li>
                                            <li><a href="@Url.Action("Index","Shop", new { sortBy = (int)SortbyEnums.Popularity })" class="@(Model.SortBy.HasValue ? Model.SortBy.Value==(int)SortbyEnums.Popularity ?"active":string.Empty:string.Empty)">Populyarity</a></li>
                                            <li><a href="@Url.Action("Index","Shop", new { sortBy = (int)SortbyEnums.PriceLowToHigh })" class="@(Model.SortBy.HasValue ? Model.SortBy.Value==(int)SortbyEnums.PriceLowToHigh ?"active":string.Empty:string.Empty)">Price: low to high</a></li>
                                            <li><a href="@Url.Action("Index","Shop", new { sortBy = (int)SortbyEnums.PriceHighToLow })" class="@(Model.SortBy.HasValue ? Model.SortBy.Value==(int)SortbyEnums.PriceHighToLow ?"active":string.Empty:string.Empty)">Price: high to low</a></li>
                                        </ul>

                                    </form>
                                </div> <!-- card-body.// -->
                            </div> <!-- collapse .// -->
                        </article> <!-- card-group-item.// -->
                        <article class="card-group-item">
                            <header class="card-header">


                                <h6 class="title">Reset Filters  </h6>

                            </header>
                            <div class="filter-content collapse show" id="collapse33">
                                <div class="card-body">

                                    <a href="@Url.Action("Index","Shop")"><button class="btn btn-block btn-outline-primary">Reset</button></a>
                                </div> <!-- card-body.// -->
                            </div> <!-- collapse .// -->

                        </article> <!-- card-group-item.// -->
                    </div> <!-- card.// -->


                </aside> <!-- col.// -->
                <main id="productsDiv" class="col-sm-9">

                    @{
                        var filterProductsViewModel = new FilterProductsViewModel();
                        filterProductsViewModel.Products = Model.Products;
                        filterProductsViewModel.Pager = Model.Pager;
                        filterProductsViewModel.CategoryID = Model.CategoryID;
                        filterProductsViewModel.SortBy = Model.SortBy;
                        Html.RenderPartial("FilterProducts", filterProductsViewModel);
                    }

                </main>
            </div>
        </div>
    </section>
    <button title="Click to return on the top page" onclick="topFunction()" id="myBtn">🠝</button>

    <footer class="section-footer bg2 ">
        <div class="container">
            <section class="footer-bottom row">
                <div class="col-sm-12 text-center">
                    <p>© 2019 Andrew Karachevtsev</p>
                </div>
            </section>
        </div>
    </footer>
</body>
</html>

<script>
    var callTimeout;
	var priceSlider = $("#slide-range").slider({
		range: true,
		min: 0,
		max: @Model.MaximumPrice,
		values: [0, @Model.MaximumPrice],
		slide: function (event, ui) {
			var minPrice = ui.values[0];
			var maxPrice = ui.values[1];
			$("#amount").val("$" + minPrice + ".00" + " - " + "$" + maxPrice + ".00");
			clearTimeout(callTimeout);
			callTimeout = setTimeout(PriceRangeChange, 500);
		}
	});

    function GetData(dUrl) {
    

        $.ajax({
            processData: false,
            url: dUrl,
            data: {
                minimumPrice: priceSlider.slider("values", 0),
                maximumPrice: priceSlider.slider("values", 1)

            }
        })
            .done(function (response) {
             
                $("#productsDiv").html(response);
            })
            .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                
              
            })
            .always(function () {
               
                hideLoader();
            });
     
    }
</script>
